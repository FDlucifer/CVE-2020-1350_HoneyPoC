# CVE-2020-1350 Exploit aka SIGRED
## RCE via DNS

### Windows Binary PoC
./CVE-2020-1350.exe will run the exploit.

<img src="http://canarytokens.com/articles/0hprgju6rg69dr6zjvvpng411/index.html">

View README.pdf for more information on how to use the binary.

### Running the exploit on Linux

Change the target IP in exploit.sh then do:

```
chmod +x exploit.sh
./exploit.sh
```

### Workaround Fix
```
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\DNS\Parameters" /v "TcpReceivePacketSize" /t REG_DWORD /d 0xFF00 /f
net stop DNS && net start DNS
```

### Additional Resources

- https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_exploit_cve_2020_1350.yml - Signa rules for detection
- https://research.checkpoint.com/2020/resolving-your-way-into-domain-admin-exploiting-a-17-year-old-bug-in-windows-dns-servers/ - Vulnerability Writeup
- https://blog.menasec.net/2019/02/threat-hunting-24-microsoft-windows-dns.html - Threathunting the vuln
- https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1350 - CVE-2020-1350 | Windows DNS Server Remote Code Execution Vulnerability
- https://msrc-blog.microsoft.com/2020/07/14/july-2020-security-update-cve-2020-1350-vulnerability-in-windows-domain-name-system-dns-server/ - July 2020 Security Update:â€¯CVE-2020-1350 Vulnerability in Windows Domain Name System (DNS) Server


### Contributers
- https://twitter.com/ZephrFish 
- https://twitter.com/TJ_Null 
- https://twitter.com/ZoomerX 
- https://twitter.com/TheCyberViking 
- https://twitter.com/rag_sec

